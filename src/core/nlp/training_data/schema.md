# OstrichDB Schema

## OstrichDB Collection File Overview

OstrichDB does not store data in JSON format or SQL tables. Instead it uses its own custom database format and file extension `.ost` to store data. Data within OstrichDB is stored in 3 components, Collections, Clusters, and Records.
Collections are the top-level data structures in OstrichDB, they are the actual database files with the `.ost` extension.

### OstrichDB Collection Metadata Header

Collections are broken into two sections. The metadata header and the body. The metadata header is the top section of the collection and contains information about the collection itselfsuch as the file format version, permission, date of creation, date last modified, file size, and checksum. The metadata header plays a crucial role in ensuring the data security and integrity of the collection and its data.

Here is an example of an OstrichDB collections metadata header:

```
@@@@@@@@@@@@@@@TOP@@@@@@@@@@@@@@@
# File Format Version: Pre_Rel_v0.8.0_dev
# Permission: Read-Write
# Date of Creation: March 21 2025
# Date Last Modified: March 21 2025
# File Size: 0 Bytes
# Checksum: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
@@@@@@@@@@@@@@@BTM@@@@@@@@@@@@@@@
```

#### Metadata Header Members

##### File Format Version
The `File Format Version` metadata header member is the version of the OstrichDB file format that the collection is using. This is used to ensure that the collection is using the correct file format version and that the data can be read and written to correctly. In its current state the `File Format Version` is set to whatever the current version of OstrichDB is.

##### Permission
Upon create of a collection the `Permission` metadata header member is set to `Read-Write`. This can be changed to `Read-Only` which means no data can be manipulated within the collection but it can be read as-is. Or this could be set to `Inaccessible` which means the collection is locked and cannot be read or written to until the permission is changed back to `Read-Write` or `Read-Only`.

##### Date of Creation
The `Date of Creation` metadata header member is the date that the collection was created.

##### Date Last Modified
The `Date Last Modified` metadata header member is the date that any data manipulation operation was last performed on the collection.

##### File Size
The `File Size` metadata header member is the size of the collection in bytes. The value excludes the size of metadata header itself and only includes the body of the collection.

##### Checksum
The `Checksum` metadata header member is a hash value that is generated from the entire collection. This value is used to ensure that the collection has not been tampered with. The checksum is recalculated after each operation is performed on the collection.

The values for the `Data Last Modified`, `File Size`, and `Checksum`, metadata heade members are automatically updated after each data manipulation operation is performed on the collection.

### OstrichDB Collection Body

The body of the collection is where the actual data is stored.The body of the collection can hold a single or several blocks of data called `Clusters`.

Clusters are the middle-level data structure in OstrichDB. In plaintext, clusters resemeble JSON objects but act more like SQL tables.
Each cluster has an opening and closing curly brace `{}`, a name which is user provided, an ID that is automatically generated by OstrichDB, and ends with a comma `,`.

Here is an example of an empty cluster withing OstrichDB:
```
{
  cluster_name :identifier: Empty_Cluster
  cluster_id :identifier: 12345678910


},
```
Clusters serve as a place to hold single or mulitple pieces of related data called `Records`.

Records are the lowest-level and most granular data structure in OstrichDB. Records are similar to key-value pairs in other databases but with a twist; each record is given an explicit data type in addition to a name and value. Records MUST have a name, data type, and value. Records also must be within a cluster.


Here is an example of a record within OstrichDB:

```
NAME :STRING: "John Doe"
```

The following are all the valid record data types within OstrichDB:

`CHAR` - A single character
`STRING` - A string of characters
`INTEGER` - A whole number
`FLOAT` - A decimal number
`BOOLEAN` - A true or false value
`DATE` - A date in the format `YYYY-MM-DD`
`TIME` - A time in the format `HH:MM:SS`
`DATETIME` - A date and time in the format `YYYY-MM-DDTHH:MM:SS`
`NULL` - A null value
`UUID` - A unique identifier in the format `xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx`
`[]CHAR` - An array of single characters
`[]STRING` - An array of strings
`[]INTEGER` - An array of whole numbers
`[]FLOAT` - An array of decimal numbers
`[]BOOLEAN` - An array of true or false values
`[]DATE` - An array of dates each value in the format `YYYY-MM-DD`
`[]TIME` - An array of times each valuein the format `HH:MM:SS`
`[]DATETIME` - An array of dates and times each value in the format `YYYY-MM-DDTHH:MM:SS`
`[]UUID` - An array of unique identifiers each value in the format `xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx`


Below is an example of an entire OstrichDB collection including the metadata header and body:
```
@@@@@@@@@@@@@@@TOP@@@@@@@@@@@@@@@
# File Format Version: Pre_Rel_v0.8.0_dev
# Permission: Read-Write
# Date of Creation: March 21 2025
# Date Last Modified: March 21 2025
# File Size: 321 Bytes
# Checksum: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
@@@@@@@@@@@@@@@BTM@@@@@@@@@@@@@@@

{
	cluster_name :identifier: John_Doe
	cluster_id :identifier: 12345678910

	NAME :STRING: "John Doe"
  AGE :INTEGER: 25
  D.O.B :DATE: "1999-01-01"
  SIBLINGS :[]String: ["Jane Doe", "Jack Doe"]
  IS_EMPLOYED :BOOLEAN: true
  SALARY :FLOAT: 50000.00
},

{
	cluster_name :identifier: Bob_Smith
	cluster_id :identifier: 10987654321

	NAME :STRING: "Bob Smith"
  AGE :INTEGER: 47
  D.O.B :DATE: "1984-10-09"
  SIBLINGS :[]String: ["Tim Smith"]
  IS_EMPLOYED :BOOLEAN: false
  SALARY :FLOAT: 0.0
},
```

### More Examples

#### Example 1: A Collection with a Single Cluster That Contains a Single Record
```
@@@@@@@@@@@@@@@TOP@@@@@@@@@@@@@@@
# File Format Version: Pre_Rel_v0.8.0_dev
# Permission: Read-Write
# Date of Creation: March 21 2025
# Date Last Modified: March 21 2025
# File Size: 321 Bytes
# Checksum: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
@@@@@@@@@@@@@@@BTM@@@@@@@@@@@@@@@

{
  cluster_name :identifier: My_Books
  cluster_id :identifier: 12345678910

  TITLES :[]STRING: ["The Great Gatsby", "1984", "To Kill a Mockingbird"]
},
```


#### Example 2: A collection with no clusters whose permssions are set to `Read-Only`
```
@@@@@@@@@@@@@@@TOP@@@@@@@@@@@@@@@
# File Format Version: Pre_Rel_v0.8.0_dev
# Permission: Read-Only
# Date of Creation: March 21 2025
# Date Last Modified: March 21 2025
# File Size: 0 Bytes
# Checksum: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
@@@@@@@@@@@@@@@BTM@@@@@@@@@@@@@@@


```

#### Example 3: A collection with a single cluster that has a single record whose permissions are set to `Inaccessible`
```
@@@@@@@@@@@@@@@TOP@@@@@@@@@@@@@@@
# File Format Version: Pre_Rel_v0.8.0_dev
# Permission: Inaccessible
# Date of Creation: March 21 2025
# Date Last Modified: March 21 2025
# File Size: 0 Bytes
# Checksum: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
@@@@@@@@@@@@@@@BTM@@@@@@@@@@@@@@@

{
  cluster_name :identifier: Top_Secret
  cluster_id :identifier: 12345678910

  PASSWORD :STRING: "SuperSecretPassword"
},
```
